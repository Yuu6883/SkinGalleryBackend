server {

    listen 80 default_server;
    listen [::]:80 default_server;
    server_name skins.vanis.io;

    location /api/ {
        proxy_pass http://localhost:3000/;
        access_log /var/log/nginx/vanis_skin_api.log;
        error_log /var/log/nginx/vanis_skin_api_err.log;
    }

    location /s/ {
        alias /home/vanis/VanisSkins/skins/;
        try_files $uri $uri.jpg @skin_not_found;
        access_log /var/log/nginx/vanis_skin.log;
        error_log /var/log/nginx/vanis_skin_err.log;
    }

    location @skin_not_found {
        return 301 /s/404;
    }

    location / {
        root /home/vanis/VanisSkins/web/;
        index index.html;
        error_page 404 = @page_not_found;
        access_log /var/log/nginx/vanis_skin_web.log;
        error_log /var/log/nginx/vanis_skin_web_err.log;
    }

    location @page_not_found {
        return 301 /;
    }
}